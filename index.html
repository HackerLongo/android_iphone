<!DOCTYPE html>
<!--HTML5 doctype-->
<html>
<head>
	<title>IBOS</title>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
	<meta name="apple-mobile-web-app-capable" content="yes" />
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- appframework -->
	<link rel="stylesheet" type="text/css" href="css/src/main.css" />
	<link rel="stylesheet" type="text/css" href="css/src/badges.css" />
	<link rel="stylesheet" type="text/css" href="css/src/buttons.css" />
	<link rel="stylesheet" type="text/css" href="css/src/lists.css" />
	<link rel="stylesheet" type="text/css" href="css/src/forms.css" />
	<link rel="stylesheet" type="text/css" href="css/src/grid.css" />
	<link rel="stylesheet" type="text/css" href="css/src/ibos.css" />
	<link rel="stylesheet" type="text/css" href="plugins/css/af.actionsheet.css" />
	<link rel="stylesheet" type="text/css" href="plugins/css/af.popup.css" />
	<link rel="stylesheet" type="text/css" href="plugins/css/af.selectBox.css" />
		
	<link rel="stylesheet" type="text/css" href="css/animate.css" />
	<link rel="stylesheet" type="text/css" href="css/ui-home.css" />
	<!-- -->
	<link rel="stylesheet" type="text/css" href="css/short.css" />
	<link rel="stylesheet" type="text/css" href="css/userselect.css" />
	<link rel="stylesheet" type="text/css" href="css/letter.css" />
	
	<script type="text/javascript" charset="utf-8" src="./appframework.js"></script>
	
	<!-- include af.desktopBrowsers.js on desktop browsers only -->
	<script type="text/javascript" >		
		if (!((window.DocumentTouch && document instanceof DocumentTouch) || 'ontouchstart' in window)) {
			var script = document.createElement("script");
			script.src = "plugins/af.desktopBrowsers.js";
			var tag = $("head").append(script);

			console.log("loaded!!!!!!!!!!!!!! ");
		}

	</script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.actionsheet.js"></script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.css3animate.js"></script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.passwordBox.js"></script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.scroller.js"></script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.selectBox.js"></script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.touchEvents.js"></script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.touchLayer.js"></script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.popup.js"></script>
	<script type="text/javascript" charset="utf-8" src="./ui/src/appframework.ui.js"></script>
	<script type="text/javascript" charset="utf-8" src="./ui/transitions/all.js"></script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.slidemenu.js"></script>
	<script type="text/javascript" charset="utf-8" src="./plugins/af.template.js"></script>
	
	
	<script type="text/javascript" charset="utf-8" src="./js/LAB.js"></script>
	<script type="text/javascript" charset="utf-8" src="./js/core.js"></script>
	<script type="text/javascript" charset="utf-8" src="./js/function.js"></script>
	<script type="text/javascript" charset="utf-8" src="./js/appsdk.js"></script>
	<script type="text/javascript" charset="utf-8" src="./js/letter.js"></script>
	<script type="text/javascript" charset="utf-8" src="./js/userselect.js"></script>
	<script type="text/javascript" charset="utf-8" src="./phonegap.js"></script>
	<script type="text/javascript">
		/* This function runs once the page is loaded, but appMobi is not yet active */
            //$.ui.animateHeaders=false;
             var search=document.location.search.toLowerCase().replace("?","");
             //if(!search)
                //$.os.useOSThemes=false;
            if(search) //Android fix has too many buggy issues on iOS - can't preview with $.os.android
            {
               $.os.useOSThemes=true;
                if(search=="win8")
                    $.os.ie=true;
                $.ui.ready(function(){
                    $("#afui").get(0).className=search;
                });
            }
		var webRoot = "./";
		$.ui.autoLaunch = false;
		$.ui.openLinksNewTab = false;
		$.ui.resetScrollers=false;
		
		$(document).ready(function(){
			$.ui.setSideMenuWidth($("#afui").width()-50);
			$.ui.launch();
			//屏蔽没侧栏的页面划动
			$("[data-nav=none]").bind("touchstart", function(e) { e.stopPropagation()});
			$("[data-nav=none]").bind("touchmove", function(e) { e.stopPropagation()});		
			$("[data-nav=none]").bind("touchend", function(e) { e.stopPropagation()});
			appInit.init();  // 初始化我的数据
		});
		
		/* This code is used to run as soon as appMobi activates */
		var onDeviceReady = function () {
			if ($.os.ios7) {
				alert(0);
				document.body.style.marginTop = "20px"; //如果是ios7则顶部预留出20像素
				
			}
			alert(1);

// result contains any message sent from the plugin call
function successHandler (result) {
    alert('result = ' + result);
}
// result contains any error description text returned from the plugin call
function errorHandler (error) {
    alert('error = ' + error);
}
function tokenHandler (result) {
    // Your iOS push server needs to know the token before it can push to this device
    // here is where you might want to send it the token for later use.
    alert('device token = ' + result);
}
var pushNotification;
alert(2);
pushNotification = window.plugins.pushNotification;
alert(3);
if ( device.platform == 'android' || device.platform == 'Android' )
{
    pushNotification.register(
        successHandler,
        errorHandler, {
            "senderID":"replace_with_sender_id",
            "ecb":"onNotificationGCM"
        });
}
else
{
    pushNotification.register(
        tokenHandler,
        errorHandler, {
            "badge":"true",
            "sound":"true",
            "alert":"true",
            "ecb":"onNotificationAPN"
        });
}
alert(5);
			AppMobi.device.setRotateOrientation("portrait");
			AppMobi.device.setAutoRotate(false);
			webRoot = AppMobi.webRoot + "";
			//hide splash screen
			AppMobi.device.hideSplashScreen();
			$.ui.blockPageScroll(); //block the page from scrolling at the header/footer
			$.ui.animateHeaders = true;
		};
        document.addEventListener("deviceready", onDeviceReady, false);
	</script>
</head>
<body>
<div id="afui" class="ibos">
	<!-- this is the splashscreen you see. -->
	<div id="splashscreen" class='ui-loader heavy'>
		 IBOS协同办公平台 <br>
		<br>
		<span class='ui-icon ui-icon-loading spin'></span>
		<h1>正在载入...</h1>
	</div>
	<!----------------------------------------------> 
	<div id="header"></div>
	<div id="content">
		<!---------------------------------------------->
			<div title='IBOS移动客户端' id="main" class="panel mainbg" data-tab="navbar_main" style="overflow:hidden;">
				<div class="home-item">
					<a href="#news" data-transition="pop">
						<i class="item-ico ico-article"></i>
						信息
					</a><a href="#mail" data-transition="pop">
						<i class="item-ico ico-mail"></i>
						邮件
					</a><a href="#diary" data-transition="pop">
						<i class="item-ico ico-diary"></i>
						工作日志
					</a><a href="#work" data-transition="pop">
						<i class="item-ico ico-work"></i>
						工作流
					</a><a href="#calendar" data-transition="pop">
						<i class="item-ico ico-calendar"></i>
						日程
					</a><a href="#report" data-transition="pop">
						<i class="item-ico ico-report"></i>
						总结与计划
					</a><a href="#doc" data-transition="pop">
						<i class="item-ico ico-doc"></i>
						公文
					</a><a href="#more" data-transition="pop">
						<i class="item-ico ico-more"></i>
						添加更多
					</a>
				</div>
			</div>
		<!---------------------------------------------->
			<div title="消息中心" id="msg" class="panel" data-tab="navbar_msg" data-nav="none" data-header="header_msg" data-defer="msg.html" data-load="loadMsg">
		<a href="#msg">ggggggggg</a></div>
			<div title="私信" id="sms" class="panel" data-tab="navbar_msg" data-nav="none" data-header="header_msg" data-defer="sms.html" data-load="loadSms"></div>
			<div title="私信" id="sms_view" class="panel" data-tab="navbar_msg" data-nav="none" data-defer="sms_view.html" data-unload="cleartime"></div>
		<!---------------------------------------------->
			<div title="企业微博" id="weibo" class="panel" data-tab="navbar_weibo" data-header="header_weibo" data-defer="weibo.html"></div>
		<!---------------------------------------------->
			<div title="个人设置" id="setting" class="panel" data-tab="navbar_setting" data-header="header_setting" data-defer="setting.html" data-load="loadSetting"></div>
			<div title="个人资料" id="setting_profile" class="panel" data-tab="navbar_setting" data-footer="none" data-defer="setting_profile.html"></div>
			
		<!---------------------------------------------->
			<div title="网络设置" id="netSetting" class="panel" data-load="showNetList" data-footer="none" data-nav="none" data-defer="net.html"></div>
			<div title="网络设置" id="netEdit" class="panel" data-footer="none" data-nav="none" data-defer="net_edit.html"></div>
			
		<!---------------------panel-------------------------> 
			<div title="信息中心" id="news" class="panel" data-header="header_news" data-nav="menu_news" data-load="loadNews" data-footer="none" data-defer="news.html"></div>
			<!-----------news-view----------->
			<div title="查看新闻" id="news_view" class="panel bgw no-nav" data-nav="menu_news" data-footer="none" data-defer="news_view.html"></div>
		<!---------------------panel------------------------->
			<!-----------mail----------->
			<div title="收件箱" id="mail" class="panel" data-nav="menu_mail" data-header="header_mail" data-load="loadEmail" data-footer="none" data-defer="mail.html"></div>
			<!-----------mail-----------> 
			<div title="写邮件" id="mail_new" class="panel bgw" data-nav="menu_mail" data-header="header_mail_new" data-footer="none" data-defer="mail_edit.html"></div>
			<!-----------mail-view-----------> 
			<div title="查看邮件" id="mail_view" class="panel bgw" data-nav="menu_mail" data-footer="footer_mail_view" data-defer="mail_view.html"></div>			
		<!---------------------panel------------------------->
			<!-----------diary-----------> 
			<div title="我的日志" id="diary" class="panel" data-header="header_diary" data-footer="none" >
				<img src="images/tmp/diary.png" width="100%">				
			</div>
			
			<!-----------work-----------> 
			<div title="待办工作" id="work" class="panel" data-header="header_work" data-footer="none" >
				<img src="images/tmp/work.png" width="100%">
			</div>
			<!-----------report-----------> 
			<div title="总结与计划" id="report" class="panel" data-header="header_report" data-footer="none">
				<img src="images/tmp/report.png" width="100%">
			</div>
			<!-----------doc-----------> 
			<div title="公文" id="doc" class="panel" data-header="header_doc" data-footer="none">
				<img src="images/tmp/doc.png" width="100%">	
			</div>
			<!-----------calendar-----------> 
			<div title="我的日程" id="calendar" class="panel" data-header="header_calendar" ></div>
			
			<div title="用户选择" id="selector" class="panel" data-header="header_selector" data-footer="none" data-defer="selector.html"></div>
			<div title="用户选择2" id="mail_selector" class="panel" data-header="header_selector" data-footer="none" data-defer="mail_selector.html"></div>

			<div title="登录" id="login" class="panel indexbg" data-defer="login.html" selected="true" data-footer="none" data-nav="none" data-load="loadLogin" data-unload="unloadLogin" style="overflow:hidden;"></div>
			<div title="添加更多" id="more" class="panel mainbg" data-nav="none" ></div>
		<!---------------------------------------------->
	</div>		
	<!---------------------------------------------->

	<!-- navbar -->
	<div id="navbar">
		<a href="#main" id='navbar_main' data-transition="none" class='icon home'>首页</a>
		<a href="#sms" id='navbar_msg' data-transition="none" class="icon msg">消息</a>
		<a href="#weibo" id='navbar_weibo' data-transition="none" class="icon weibo">微博</a>
		<a href="#setting" id='navbar_setting' data-transition="none" class="icon setting">设置</a> 
	</div>
	<!--------------------footer-------------------------->
	<footer id="footer_news"></footer>
	<footer id="footer_mail"></footer>
	<footer id="footer_mail_view" class="toolbar">
		<!-- <div class="toolbar"> -->
			<a href="javascript:;" onclick="Email.markMail()">
				<i class="o-mark"></i>
			</a>
			<a href="#" onclick="Email.replyMail()">
				<i class="o-reply"></i>
			</a>
			<a href="javascript:;" onclick="Email.replyAll()">
				<i class="o-reply-all"></i>
			</a>
			<a href="javascript:;" onclick="Email.deleteMail()">
				<i class="o-delete"></i>
			</a>
		<!-- </div> -->
	</footer>
	<!--------------------header-------------------------->	
	<header id="header_news">
		<a onclick='af.ui.toggleSideMenu()' class='button ao-menu'></a>
		<h1>信息中心</h1>
		<a onclick="$.ui.goBack();" class='button ao-home'></a>
	</header>
	<header id="header_mail">
		<a onclick='af.ui.toggleSideMenu()' class='button ao-menu'></a>
		<h1>我的收件箱</h1>
		<a onclick="$.ui.goBack();" class='button ao-home'></a>
	</header>

	<!-- Header: 新建邮件 -->
	<header id="header_mail_new">
		<a onclick='af.ui.goBack()' class='button ao-cancel'></a>
		<h1>新建邮件</h1>
		<a onclick="Email.sendMail();" class='button ao-send'></a>
	</header>
	
	<header id="header_diary">
		<a onclick='af.ui.toggleSideMenu()' class='button ao-menu'></a>
		<h1>工作日志</h1>
		<a onclick="$.ui.goBack();" class='button ao-home'></a>
	</header>
	<header id="header_report">
		<a onclick='af.ui.toggleSideMenu()' class='button ao-menu'></a>
		<h1>总结与计划</h1>
		<a onclick="$.ui.goBack();" class='button ao-home'></a>
	</header>
	<header id="header_work">
		<a onclick='af.ui.toggleSideMenu()' class='button ao-menu'></a>
		<h1>工作流</h1>
		<a onclick="$.ui.goBack();" class='button ao-home'></a>
	</header>
	<header id="header_doc">
		<a onclick='af.ui.toggleSideMenu()' class='button ao-menu'></a>
		<h1>公文</h1>
		<a onclick="$.ui.goBack();" class='button ao-home'></a>
	</header>
	<header id="header_calendar">
		<a onclick='af.ui.toggleSideMenu()' class='button ao-menu'></a>
		<h1>我的日程</h1>
		<a onclick="$.ui.goBack();" class='button ao-home'></a>
	</header>
	<!-- Header: 消息中心 -->
	<header id="header_msg">
		<h1>消息中心</h1>
		<a href="javascript:;" class="button ao-edit" onclick="Sms.addSms()"></a>
	</header>
	<header id="header_weibo">
		<a class='button ao-menu' onclick='af.ui.toggleSideMenu()'></a>
		<h1>最新记录</h1>
	</header>
	<header id="header_setting">
		<a class='button ao-menu' onclick='af.ui.toggleSideMenu()'></a>
		<h1>个人设置</h1>
	</header>

	<!-- Header: 用户选择列表 -->
	<header id="header_selector">
		<a href="javascript:;" class="button ao-cancel" onclick="$.ui.goBack()"></a>
		<h1>用户选择</h1>
		<a href="javascript:;" class="button ao-ok" onclick="appInit.userSelector.save()"></a>
	</header>

	<!---------------------nav------------------------->
	<nav>
		<ul class="list">
			<li class="divider icon home">侧边栏</li>
		</ul>
		<a class="button orange" onClick="appInit.logout()">退出登录</a>
	</nav>
	<nav id="menu_news">
		<ul class="list list-ico" id="newsCat">
			<li class="divider"> 信息中心 </li>
			<li> <a href="#news" onclick="news.loadList(0)"><i class="o-news-all"></i>全部</a> </li>
			<li> <a href="#news" onclick="news.loadList(-1)"><i class="o-news-catnew"></i>最新公告</a> </li>
			<li> <a href="#news" onclick="news.loadList(-2)"><i class="o-news-read"></i>已读公告</a> </li>
			<li class="divider">分类查看</li>
			<textarea style="display:none" type="text/ibos-template" id="newsCatTpl">
				<li <%=classname%>> <a href="#news" onclick="news.loadList(<%=catid%>)"><i class="o-news-cat"></i><%=name%></a> </li>
			</textarea>
		</ul>
	</nav>
	<nav id="menu_mail">
		<a href="javascript:;" onclick="Email.editMail()" class="button orange">写邮件</a>
		<ul class="list list-ico" id="mailCat">
			<li id="inbox"> <a href="#mail" onclick="Email.loadList('inbox')"><i class="o-inbox"></i>收件箱</a> </li>
			<li> <a href="#mail" onclick="Email.loadList('todo')"><i class="o-mark"></i>待办邮件</a> </li>
			<li> <a href="#mail" onclick="Email.loadList('draft')"><i class="o-draft"></i>草稿箱</a> </li>
			<li> <a href="#mail" onclick="Email.loadList('send')"><i class="o-send"></i>已发送</a> </li>
			<li> <a href="#mail" onclick="Email.loadList('del')"><i class="o-delete"></i>已删除</a> </li>
			<li class="divider">我的文件夹</li>
			<textarea style="display:none" type="text/ibos-template" id="mailCatTpl">
				<li <%=classname%>> <a href="#mail" onclick="Email.loadList(<%=boxid%>)"><i class="o-folder"></i> <%=name%></a> </li>
			</textarea>
		</ul>
	</nav>
</div>
</body>
</html>
